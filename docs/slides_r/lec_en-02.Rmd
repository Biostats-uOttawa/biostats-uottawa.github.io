---
title: "Getting the data in R"
author: 
  - "Julien Martin"
institute: "University of Ottawa"
output:
  xaringan::moon_reader:
    css: ["assets/css/rutgers-img.css", "assets/css/rutgers-fonts_og.css"]
    lib_dir: "assets/libs"
    nature:
      highlightStyle: github
      highlightLanguage: ["r", "yaml", "markdown"]
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
knit: pagedown::chrome_print
---

```{css, echo=FALSE}
.title-slide {
  background-image: url(assets/img/Rlogo.png);
}
```

```{r setup1, include=FALSE}
knitr::opts_chunk$set(fig.retina = 3, warning = FALSE, message = FALSE)
```


# Learning outcomes

.medium[

- recognise different types of data in R `r emo::ji("heavy_check_mark")`

- understand some different data structures `r emo::ji("heavy_check_mark")`

- learn how to import data into R `r emo::ji("heavy_check_mark")`

- learn how to manipulate data in R `r emo::ji("heavy_check_mark")`

- learn how to export data from R `r emo::ji("heavy_check_mark")`
]

---
background-image: url(assets/img/data_types.png)
background-size: 600px
background-position: 95% 50%

# types of data in R

.pull-left[
.large[
six types of data in R
]
.medium[
>**numeric** - 1.618, 3.14, 2.718 

>**integers** - 1, 2, 3, 42, 101 

>**logical** - TRUE or FALSE  

>**character** - "BI5009", "Blue" 

>**complex**

>**raw**
]
]
---

background-image: url(assets/img/data_structures.png)
background-size: 600px
background-position: 80% 50%

# data structures

.pull-left[
.large[
five data structures
]
.medium[
>**vector** 

>**matrix** 

>**array** 

>**data frame**  

>**list** 
]
]

---

background-image: url(assets/img/scal_vec.png)
background-size: 500px
background-position: 90% 50%

# vectors

.pull-left[
.medium[
- one dimensional collection elements 

- can contain all data types  

- all elements must be of the same type 

```{r, vec, prompt=TRUE, eval=FALSE, collapse=TRUE}
num <- 42
numbers <- c(2, 3, 4, 5, 6)
char <- c("red", "green")
log <- c(TRUE, TRUE, FALSE)
my_na <- c(NA, NA, NA, NA)
mix <- c(1, 2, 3, NA, 5)
```
]
]

---

background-image: url(assets/img/mat_array.png)
background-size: 500px
background-position: 95% 50%

# matrices and arrays

.pull-left[
.medium[
- a vector with extra dimensions

- again, objects must be of the same type 

- arrays are multidimensional matrices  

```{r, mat, prompt=TRUE, collapse=TRUE}
mat.1 <- matrix(1:12, nrow=4)
mat.1
```

```{r, array, prompt=TRUE, collapse=TRUE}
array.1 <- array(1:16, dim=c(2,4,2))
```
]
]
---

# data frames

.medium[
- most commonly used data structure for statistical data analysis

- powerful 2-dimensional vector holding structure

- dataframes can hold vectors of any of the basic classes of data 
]

```{r, df1, echo=FALSE, comment=""}
flowers <- read.csv('data/flower.csv')
head(flowers, n = 10)
```
---

background-image: url(assets/img/tidy-1.png)
background-size: 1200px
background-position: 50% 50%

# tidy data
---

background-image: url(assets/img/excel.png)
background-size: 500px
background-position: 95% 50%

# importing data

.medium[
- simplest method is to use spreadsheet  
and then import data into R 

- use either MS Excel or  LibreOffice calc

- File --> Save as ... menu

- save as a comma separated file (*.csv) 

- missing data represented with NA

- no spaces in names (use underscore if needed)

- no uppercase

- keep variable names short & informative
]

---

# importing data

.medium[
- the `read.table()` function is the workhorse with format specified function to make coding faster
]

<br>

.center[
.huge[
```r
  petunia <- read.table('data/flowers.csv', header = TRUE, sep = ',')
```
]
]

--
background-image: url(assets/img/braces.png)
background-size: 250px
background-position: 6% 65%
--
background-image: url(assets/img/braces2.png)
background-size: 300px
background-position: 25% 65%
--
background-image: url(assets/img/braces3.png)
background-size: 300px
background-position: 45% 65%
--
background-image: url(assets/img/braces4.png)
background-size: 300px
background-position: 72% 65%
--
background-image: url(assets/img/braces5comma.png)
background-size: 300px
background-position: 95% 65%

---

# importing data

.medium[
- sometimes columns are separated by tabs 
.center[`petunia <- read.table('data/flowers.csv', header = TRUE,` .red[sep = '\t'])`]

- you can use format specific functions
.center[`petunia <-` .red[read.csv]`('flowers.csv')`      # if comma-separated]  
.center[`petunia <-` .red[read.delim]`('flowers.txt')`      # if tab-separated] 

- functions in the `foreign` package allows you to import files of other formats (i.e. from SAS, SPSS, Minitab etc)

- use the `readxl` or `readODS` package to directly import MS Excel or LO calc spreadsheets directly

]

---

# importing data

.medium[
- to view the contents of a data frame, type it's name

- rarely a good idea as just fills up your console

- use the `head()` and `tail()` to see first/last 6 lines
]

```{r, flow1, echo=FALSE, eval=c(1,2,3), collapse=TRUE, prompt=TRUE, comment=""}
print('flowers', quote = FALSE)
flowers <- read.csv('data/flower.csv')
head(flowers)
```

---

# data wrangling

.medium[
- `str()` function:  data frame dimensions, list of variables, type of variables
]
```{r, flow2, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
str(flowers)
```

.medium[
- `names()` function: vector of variable names 
]

```{r, flow3, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
names(flowers)
```

---

# data wrangling

.medium[
- access variables in your data frame using the `$` notation
]

```{r, flow4, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
flowers$height
```

.medium[
- you can extract elements in the data frame using  the `[rowIndex, columnIndex]` method 

- `Index` can either be a positional index or a logical index
]
---
# positional index

.medium[
- provide the row and column position of the data you wish to extract 

- `index` can either be a positional index or a logical index
]

```{r, flow5, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
flowers[1, 4]      # extract value of first row and 4th column
```

.medium[
- extract multiple elements by supplying vectors for `rowIndex` and `columnIndex` 
]
```{r, flow6, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
flowers[1:3, 1:4]      # extract rows 1 to 3 and columns 1 to 4
```

---
# positional index

.medium[
- another example
]

```{r, flow7, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
flowers[c(3,8,20), c(1, 4, 5, 6)]     # rows 3, 8 and 20 and columns 1, 4, 5 and 6
```

.medium[
- can assign these extracted values to another object if you want

- new object inherits `data.frame` class
]

```{r, flow8, echo=TRUE,  collapse=TRUE, prompt=TRUE, comment=""}
flowers_red <- flowers[c(3,8,20), c(1, 4, 5, 6)]
flowers_red
```

---
# positional index

.medium[
- we can use a short cut if we want all rows or all columns extracted

- omitting the column index is shorthand for 'all columns'
]

```{r, flow9, echo=TRUE, collapse=TRUE, prompt=TRUE, comment=""}
flowers[1:3, ]
```

.medium[
- omitting the row index is shorthand for 'all rows'
]

```{r, flow10, echo=TRUE, eval=FALSE, prompt=TRUE}
flowers[, 1:3]
```


---
# positional index

.medium[
- an alternative method to select columns is to name the columns directly for `columnIndex`
]

```{r, flow11, echo=TRUE, collapse=TRUE, prompt=TRUE, comment=""}
flowers[1:10, c('treat', 'nitrogen', 'leafarea', 'shootarea')]
```


---
# logical index

.medium[
- we can also extract rows based on a logical test

- example, let's extract all rows where the `height` variable is greater than 12 
]

```{r, flow12, echo=TRUE, collapse=TRUE, prompt=TRUE, comment=""}
flowers[flowers$height > 12,]
```

.medium[
- or where `leafarea` is equal to 8.7
]

```{r, flow13, echo=TRUE, collapse=TRUE, prompt=TRUE, comment=""}
flowers[flowers$leafarea == 8.7,]
```

---
# logical index

.medium[
- we can combine logical tests using the `&` symbol (AND) or the `|` symbol (OR)

- example, extract all rows where `height` is > 10.5 and `nitrogen` is equal to `"medium"`
]

```{r, flow14, echo=TRUE, collapse=TRUE, prompt=TRUE, comment=""}
flowers[flowers$height > 10.5 & flowers$nitrogen == 'medium',]
```

.medium[
- or `height` is greater than 12.3 OR less than 1.8
]

```{r, flow15, echo=TRUE, collapse=TRUE, prompt=TRUE, comment=""}
flowers[flowers$height > 12.3 | flowers$height < 1.8,]
```

---

# exporting data frames

.medium[
- the `write.csv()` function exports data frames to an external file

<br>

.center[
`write.csv(flowers, 'flowers2.csv', row.names = FALSE)`
]

<br>
- saves `flowers` data frame to a file named 'flowers.csv'

- `row.names = FALSE` argument supresses the row names in the file
]

---
# other options

.medium[
- there are many other options for importing and exporting data in R

- the `fread()` and `fwrite()` functions in the `read.table` package are blazingly fast

- the `read_csv()` and `write_csv()` (and other related) functions from the `readr` package for tidyverse alternatives

- if you have a lot of data (I mean alot!) then take a look at the `ff` and `bigmemory` packages
]


---
class: title-slide-final, middle
background-size: 55px
background-position: 9% 15%

# Thanks!

### I created these slides with [xaringan](https://github.com/yihui/xaringan) and [R Markdown](https://rmarkdown.rstudio.com/) using the [rutgers css](https://github.com/jvcasillas/ru_xaringan) that I slightly modified.

### Credit: I borrowed slides from [Alex Douglas](https://github.com/alexd106/).

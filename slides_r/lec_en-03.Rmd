---
title: "Simple statistics using R"
author: Julien Martin
institute: "University of Ottawa"
output:
  xaringan::moon_reader:
    css: ["assets/css/rutgers-img.css", "assets/css/rutgers-fonts_og.css"]
    lib_dir: "assets/libs"
    nature:
      highlightStyle: github
      highlightLanguage: ["r", "yaml", "markdown"]
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
knit: pagedown::chrome_print
---

```{css, echo=FALSE}
.title-slide {
  background-image: url(assets/img/Rlogo.png);
}
```

```{r setup1, include=FALSE}
knitr::opts_chunk$set(fig.retina = 3, warning = FALSE, message = FALSE)
```

# learning outcomes

.pull-left[
.medium[

- introduce you to some basic statistics in R  `r emo::ji("heavy_check_mark")`

- focus on linear models `r emo::ji("heavy_check_mark")`

- fit simple linear models in R `r emo::ji("heavy_check_mark")`

- check linear model assumptions in R `r emo::ji("heavy_check_mark")`

]
]

.pull-right[
<img src = "assets/img/assume.gif" width = 900px height = 275px>

]
---

class: top, left

# statistics using R

.pull-left[
.medium[
- many, many statistical tests available in R 

- range from the simple to the highly complex

- many are included in standard base installation  of R

- you can extend the range of statistics by installing additional packages
]
]

.pull-right[
.center[
```{r image1, echo=FALSE, out.width= '70%'}
knitr::include_graphics('assets/img/stats.gif')
```
]
]

---

background-image: url(assets/img/clouds.gif)
background-size: 500px
background-position: 95% 60%

class: top, left

# statistics using R

### an example 

.pull-left[
.medium[

- does seeding clouds with dimethylsulphate alter the moisture content of clouds (can we make it rain!)

- 10 random clouds were seeded and 10 random clouds unseeded

-  what’s the null hypothesis?

- no difference in mean moisture content between seeded and unseeded clouds

]
]

---

class: top, left

# statistics using R

.pull-left[
.medium[

- plot these data

- interpretation?

-  what type of statistical test do you want to use?

<br>
```{r import, echo=2, collapse=TRUE}
clouds <- read.csv('data/clouds.csv')
str(clouds)
```

]
]

.pull-right[
.center[
```{r plot, echo=FALSE, message=FALSE, out.width= '90%'}
library(ggplot2)
ggplot(clouds, aes(x = treatment, y = moisture, colour = treatment)) +
  geom_boxplot() +
  labs(y = "moisture content", x = "treatment") +
  theme(legend.position = "none",
    axis.text.x = element_text(size=16),
    axis.text.y = element_text(size=16),
    axis.title.x = element_text(size=18),
    axis.title.y = element_text(size=18))
```
]
]

---

class: left, middle

# statistics using R

```{r, stats1, echo=TRUE, eval=TRUE}
t.test(clouds$moisture~clouds$treatment, var.equal=TRUE)


```
.medium[
- reject or fail to reject the null hypothesis?
]
---

# statistics using R

.medium[
- biological interpretation?

- assumptions?

 + normality within each group?
 
 + equal variance between groups?

- could test for normality with Shapiro-Wilks test for each group separately (I'll show you a much better ways to do this later)

```{r, stats2, eval=FALSE}
# normality for seeded streatment
shapiro.test(clouds$moisture[clouds$treatment=="seeded"])

# normality for unseeded streatment
shapiro.test(clouds$moisture[clouds$treatment=="unseeded"])
```
]

---

# statistics using R

.medium[
- null hypotheses? 
]

```{r, stats3, echo=TRUE, eval=TRUE}
# normality for seeded streatment
shapiro.test(clouds$moisture[clouds$treatment=="seeded"])

# normality for unseeded streatment
shapiro.test(clouds$moisture[clouds$treatment=="unseeded"])

```

.medium[
- fail to reject null hypotheses for both groups, therefore not different from normal
]

---

# statistics using R

.medium[
- test equal variance using an *F* test

- null hypothesis?

```{r, stats4, eval=TRUE}
var.test(clouds$moisture~clouds$treatment)
```

- fail to reject null hypotheses and therefore variances are equal
]

---

# linear models in R

<br>
.medium[

- an alternative, but equivalent approach is to use a linear model to compare the means in each group

- general linear models are generally thought of as simple models, but can be used to model a wide variety of data and exp. designs

- traditionally statistics is performed (and taught) like using a recipe book (ANOVA, *t*-test, ANCOVA etc) 

- general linear models provide a coherent and theoretically satisfying framework on which to conduct your analyses 
]

---

background-image: url(assets/img/mind.gif)
background-size: 350px
background-position: 70% 60%

# what are linear models?

.pull-left[
.medium[

- *t*-test

- ANOVA

- factorial ANOVA

- ANCOVA

- linear regression

- multiple regression

- etc, etc

]
]

---

# model formulae

.medium[
- general linear modelling is based around the concept of model formulae

<br>
.center[`response variable ~ explanatory variable(s) + error`]
<br>
- literally read as *‘variation in response variable modelled as a 
  function of the explanatory variable(s) plus variation not explained
  by the explanatory variables’*
  
- it's the attributes of the response and explanatory variables that determines the type of linear model fitted 

.pull-left[
`response ~ continous variable` 

`response ~ categorical variable`
]

.pull-right[
equivalent to simple linear regression

equivalent to one-way ANOVA
]
]

---

# linear modelling in R

.medium[

-  the function for carrying out linear regression in R is `lm()`

-the response variable comes first, then the tilde `~` then the name of the explanatory variable

```{r, stats5, collapse=TRUE}
clouds.lm <- lm(moisture ~ treatment, data=clouds)
```

- how does R know that you want to perform a *t*-test (ANOVA)?

```{r, stats6, collapse=TRUE}
class(clouds$treatment)
```

- here the explanatory variable is a factor

]

---

# linear modelling in R

.medium[

- to display the ANOVA table use the `anova()` function

```{r, stats7, eval=TRUE}
anova(clouds.lm)
```

- do you notice anything familiar about the p value? 

- (hint: see the output from the *t*-test we did earlier)
]

---

background-image: url(assets/img/seed_plot.png)
background-size: 400px
background-position: 85% 85%
# linear modelling in R

.medium[
- we have sufficient evidence to reject the null hypothesis (as before) 

- therefore, there is a significant difference in the mean moisture content between clouds that were seeded and unseeded clouds

- do we accept this inference?

- what about assumptions?

- we could use Shapiro-Wilks and *F* tests  
as before

- much better to assess visually by  
plotting the residuals

]

---

# linear modelling in R

.medium[
- because `clouds.lm` is a linear model object we can do stuff with it

- we can use the `plot()` function directly  
to display residual plots

.pull-left[
```{r, stats8, eval=FALSE}
par(mfrow = c(2, 2))
plot(clouds.lm)
```

- normality assumption

- equal variance assumption

- unusual or influential observations
]
]

--
background-image: url(assets/img/res_plots.png)
background-size: 500px
background-position: 95% 95%

--
background-image: url(assets/img/res_plots_norm.png)
background-size: 500px
background-position: 95% 95%

--
background-image: url(assets/img/res_plots-hetero.png)
background-size: 500px
background-position: 95% 95%

--
background-image: url(assets/img/res_plots-lev.png)
background-size: 500px
background-position: 95% 95%

---

# other linear models

.center[

traditional name       |   model formula           |   R code                 |
:----------------------|:--------------------------|:-------------------------|
simple linear regression   |   Y ~ X1 (continuous)     |   `lm(Y ~ X)`
one-way ANOVA          |  Y ~ X1 (categorical)     | `lm(Y ~ X)`
two-way ANOVA          | Y ~ X1 (cat) + X2 (cat)   | `lm(Y ~ X1 + X2)` 
ANCOVA                 | Y ~ X1 (cat) + X2 (cont)  | `lm(Y ~ X1 * X2)`
multiple regression    | Y ~ X1 (cont) + X2 (cont) | `lm(Y ~ X1 + X2)`
factorial ANOVA        | Y ~ X1 (cat) * X2 (cat)   | `lm(Y ~ X1 * X2)`
]
]

---
class: title-slide-final, middle
background-size: 55px
background-position: 9% 15%

# Thanks!

### I created these slides with [xaringan](https://github.com/yihui/xaringan) and [R Markdown](https://rmarkdown.rstudio.com/) using the [rutgers css](https://github.com/jvcasillas/ru_xaringan) that I slightly modified.

### Credit: I borrowed slides from [Alex Douglas](https://github.com/alexd106/).
